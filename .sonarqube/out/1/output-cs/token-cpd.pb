Ç>
b/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Controllers/ProductAPIController.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $
Controllers$ /
;/ 0
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

  
ProductAPIController

 !
:

" #
ControllerBase

$ 2
{ 
	protected 
ResponseDto 
	_response #
;# $
private 
IProductRepository 
_productRepository 1
;1 2
public 
 
ProductAPIController 
(  
IProductRepository  2
productRepository3 D
)D E
{ 
_productRepository 
= 
productRepository .
;. /
this 
. 
	_response 
= 
new 
ResponseDto (
(( )
)) *
;* +
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
object 
> 
Get !
(! "
)" #
{ 
try 
{ 	
IEnumerable 
< 

ProductDto "
>" #
productDtos$ /
=0 1
await2 7
_productRepository8 J
.J K
GetProductsK V
(V W
)W X
;X Y
	_response 
. 
Result 
= 
productDtos *
;* +
} 	
catch 
( 
	Exception 
e 
) 
{ 	
	_response 
. 
	IsSuccess 
=  !
false" '
;' (
	_response   
.   
ErrorMessages   #
=  $ %
new  & )
List  * .
<  . /
string  / 5
>  5 6
(  6 7
)  7 8
{  9 :
e  ; <
.  < =
ToString  = E
(  E F
)  F G
}  H I
;  I J
}!! 	
return## 
	_response## 
;## 
}$$ 
[&& 
HttpGet&& 
]&& 
['' 
Route'' 

(''
 
$str'' 
)'' 
]'' 
public(( 

async(( 
Task(( 
<(( 
object(( 
>(( 
Get(( !
(((! "
int((" %
id((& (
)((( )
{)) 
try** 
{++ 	
var,, 

productDto,, 
=,, 
await,, "
_productRepository,,# 5
.,,5 6
GetProductById,,6 D
(,,D E
id,,E G
),,G H
;,,H I
	_response-- 
.-- 
Result-- 
=-- 

productDto-- )
;--) *
}.. 	
catch// 
(// 
	Exception// 
e// 
)// 
{00 	
	_response11 
.11 
	IsSuccess11 
=11  !
false11" '
;11' (
	_response22 
.22 
ErrorMessages22 #
=22$ %
new22& )
List22* .
<22. /
string22/ 5
>225 6
(226 7
)227 8
{229 :
e22; <
.22< =
ToString22= E
(22E F
)22F G
}22H I
;22I J
}33 	
return55 
	_response55 
;55 
}66 
[88 
	Authorize88 
]88 
[99 
HttpPost99 
]99 
public:: 

async:: 
Task:: 
<:: 
object:: 
>:: 
Post:: "
(::" #
[::# $
FromBody::$ ,
]::, -

ProductDto::. 8

productDto::9 C
)::C D
{;; 
try<< 
{== 	
var>> 
model>> 
=>> 
await>> 
_productRepository>> 0
.>>0 1
CreateUpdateProduct>>1 D
(>>D E

productDto>>E O
)>>O P
;>>P Q
	_response?? 
.?? 
Result?? 
=?? 
model?? $
;??$ %
}@@ 	
catchAA 
(AA 
	ExceptionAA 
eAA 
)AA 
{BB 	
	_responseCC 
.CC 
	IsSuccessCC 
=CC  !
falseCC" '
;CC' (
	_responseDD 
.DD 
ErrorMessagesDD #
=DD$ %
newDD& )
ListDD* .
<DD. /
stringDD/ 5
>DD5 6
(DD6 7
)DD7 8
{DD9 :
eDD; <
.DD< =
ToStringDD= E
(DDE F
)DDF G
}DDH I
;DDI J
}EE 	
returnGG 
	_responseGG 
;GG 
}HH 
[JJ 
	AuthorizeJJ 
]JJ 
[KK 
HttpPutKK 
]KK 
publicLL 

asyncLL 
TaskLL 
<LL 
objectLL 
>LL 
PutLL !
(LL! "
[LL" #
FromBodyLL# +
]LL+ ,

ProductDtoLL- 7

productDtoLL8 B
)LLB C
{MM 
tryNN 
{OO 	
varPP 
modelPP 
=PP 
awaitPP 
_productRepositoryPP 0
.PP0 1
CreateUpdateProductPP1 D
(PPD E

productDtoPPE O
)PPO P
;PPP Q
	_responseQQ 
.QQ 
ResultQQ 
=QQ 
modelQQ $
;QQ$ %
}RR 	
catchSS 
(SS 
	ExceptionSS 
eSS 
)SS 
{TT 	
	_responseUU 
.UU 
	IsSuccessUU 
=UU  !
falseUU" '
;UU' (
	_responseVV 
.VV 
ErrorMessagesVV #
=VV$ %
newVV& )
ListVV* .
<VV. /
stringVV/ 5
>VV5 6
(VV6 7
)VV7 8
{VV9 :
eVV; <
.VV< =
ToStringVV= E
(VVE F
)VVF G
}VVH I
;VVI J
}WW 	
returnYY 
	_responseYY 
;YY 
}ZZ 
[\\ 
	Authorize\\ 
(\\ 
Roles\\ 
=\\ 
$str\\ 
)\\  
]\\  !
[]] 

HttpDelete]] 
]]] 
[^^ 
Route^^ 

(^^
 
$str^^ 
)^^ 
]^^ 
public__ 

async__ 
Task__ 
<__ 
object__ 
>__ 
Delete__ $
(__$ %
int__% (
id__) +
)__+ ,
{`` 
tryaa 
{bb 	
boolcc 
	isSuccesscc 
=cc 
awaitcc "
_productRepositorycc# 5
.cc5 6
DeleteProductcc6 C
(ccC D
idccD F
)ccF G
;ccG H
	_responsedd 
.dd 
Resultdd 
=dd 
	isSuccessdd (
;dd( )
}ee 	
catchff 
(ff 
	Exceptionff 
eff 
)ff 
{gg 	
	_responsehh 
.hh 
	IsSuccesshh 
=hh  !
falsehh" '
;hh' (
	_responseii 
.ii 
ErrorMessagesii #
=ii$ %
newii& )
Listii* .
<ii. /
stringii/ 5
>ii5 6
(ii6 7
)ii7 8
{ii9 :
eii; <
.ii< =
ToStringii= E
(iiE F
)iiF G
}iiH I
;iiI J
}jj 	
returnll 
	_responsell 
;ll 
}mm 
}oo ‹
a/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/DbContexts/ApplicationDbContext.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $

DbContexts$ .
;. /
public 
class  
ApplicationDbContext !
:! "
	DbContext# ,
{ 
public 
 
ApplicationDbContext 
(  
DbContextOptions  0
<0 1 
ApplicationDbContext1 E
>E F
optionsG N
)N O
:O P
baseQ U
(U V
optionsV ]
)] ^
{		 
} 
public 

DbSet 
< 
Product 
> 
Products "
{# $
get% (
;( )
set* -
;- .
}/ 0
	protected 
override 
void 
OnModelCreating +
(+ ,
ModelBuilder, 8
modelBuilder9 E
)E F
{ 
base 
. 
OnModelCreating 
( 
modelBuilder )
)) *
;* +
modelBuilder 
. 
Entity 
< 
Product #
># $
($ %
)% &
.& '
HasData' .
(. /
new/ 2
Product3 :
{ 
	ProductId 
= 
$num 
, 
Name 
= 
$str 
,  
Price 
= 
$num 
, 
Description 
= 
$str	 ˘
,
˘ ˙
ImageUrl 
= 
$str O
,O P
CategoryName 
= 
$str *
} 
) 
; 
modelBuilder 
. 
Entity 
<  
Product  '
>' (
(( )
)) *
.* +
HasData+ 2
(2 3
new3 6
Product7 >
{ 
	ProductId 
= 
$num 
, 
Name 
= 
$str %
,% &
Price 
= 
$num 
, 
Description   
=   
$str	   ˘
,
  ˘ ˙
ImageUrl!! 
=!! 
$str!! O
,!!O P
CategoryName"" 
="" 
$str"" *
}## 
)## 
;## 
modelBuilder$$ 
.$$ 
Entity$$ 
<$$  
Product$$  '
>$$' (
($$( )
)$$) *
.$$* +
HasData$$+ 2
($$2 3
new$$3 6
Product$$7 >
{%% 
	ProductId&& 
=&& 
$num&& 
,&& 
Name'' 
='' 
$str'' "
,''" #
Price(( 
=(( 
$num(( 
,(( 
Description)) 
=)) 
$str	)) ˘
,
))˘ ˙
ImageUrl** 
=** 
$str** O
,**O P
CategoryName++ 
=++ 
$str++ (
},, 
),, 
;,, 
modelBuilder-- 
.-- 
Entity-- 
<--  
Product--  '
>--' (
(--( )
)--) *
.--* +
HasData--+ 2
(--2 3
new--3 6
Product--7 >
{.. 
	ProductId// 
=// 
$num// 
,// 
Name00 
=00 
$str00 "
,00" #
Price11 
=11 
$num11 
,11 
Description22 
=22 
$str	22 ˘
,
22˘ ˙
ImageUrl33 
=33 
$str33 O
,33O P
CategoryName44 
=44 
$str44 '
}55 
)55 
;55 
}66 
}77 Ï
O/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/MappingConfig.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
;# $
public 
class 
MappingConfig 
{ 
public 

static 
MapperConfiguration %
RegisterMap& 1
(1 2
)2 3
{		 
var

 
mappingConfig

 
=

 
new

 
MapperConfiguration

  3
(

3 4
config

4 :
=>

; =
{ 	
config 
. 
	CreateMap 
< 

ProductDto '
,' (
Product) 0
>0 1
(1 2
)2 3
.3 4

ReverseMap4 >
(> ?
)? @
;@ A
} 	
)	 

;
 
return 
mappingConfig 
; 
} 
} ô
o/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Migrations/20211222161306_AddProductModelToDb.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $

Migrations$ .
{ 
public 

partial 
class 
AddProductModelToDb ,
:- .
	Migration/ 8
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
	ProductId 
= 
table  %
.% &
Column& ,
<, -
int- 0
>0 1
(1 2
type2 6
:6 7
$str8 =
,= >
nullable? G
:G H
falseI N
)N O
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Price 
= 
table !
.! "
Column" (
<( )
double) /
>/ 0
(0 1
type1 5
:5 6
$str7 >
,> ?
nullable@ H
:H I
falseJ O
)O P
,P Q
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
,^ _
CategoryName  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
$str> M
,M N
nullableO W
:W X
falseY ^
)^ _
,_ `
ImageUrl 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
	ProductId; D
)D E
;E F
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name   
:   
$str    
)    !
;  ! "
}!! 	
}"" 
}## ◊
h/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Migrations/20211222195130_SeedProducts.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $

Migrations$ .
{ 
public 

partial 
class 
SeedProducts %
:& '
	Migration( 1
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 

InsertData '
(' (
table 
: 
$str !
,! "
columns 
: 
new 
[ 
] 
{  
$str! ,
,, -
$str. <
,< =
$str> K
,K L
$strM W
,W X
$strY _
,_ `
$stra h
}i j
,j k
values 
: 
new 
object "
[" #
,# $
]$ %
{ 
{ 
$num 
, 
$str $
,$ %
$str	& Å
,
Å Ç
$str
É ∑
,
∑ ∏
$str
π ¡
,
¡ ¬
$num
√ «
}
» …
,
…  
{ 
$num 
, 
$str $
,$ %
$str	& Å
,
Å Ç
$str
É ∑
,
∑ ∏
$str
π «
,
« »
$num
… Œ
}
œ –
,
– —
{ 
$num 
, 
$str "
," #
$str	$ ˇ
,
ˇ Ä
$str
Å µ
,
µ ∂
$str
∑ ¬
,
¬ √
$num
ƒ …
}
  À
,
À Ã
{ 
$num 
, 
$str !
,! "
$str	# ˛
,
˛ ˇ
$str
Ä ¥
,
¥ µ
$str
∂ ¡
,
¡ ¬
$num
√ «
}
» …
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DeleteData '
(' (
table 
: 
$str !
,! "
	keyColumn 
: 
$str &
,& '
keyValue 
: 
$num 
) 
; 
migrationBuilder 
. 

DeleteData '
(' (
table 
: 
$str !
,! "
	keyColumn   
:   
$str   &
,  & '
keyValue!! 
:!! 
$num!! 
)!! 
;!! 
migrationBuilder## 
.## 

DeleteData## '
(##' (
table$$ 
:$$ 
$str$$ !
,$$! "
	keyColumn%% 
:%% 
$str%% &
,%%& '
keyValue&& 
:&& 
$num&& 
)&& 
;&& 
migrationBuilder(( 
.(( 

DeleteData(( '
(((' (
table)) 
:)) 
$str)) !
,))! "
	keyColumn** 
:** 
$str** &
,**& '
keyValue++ 
:++ 
$num++ 
)++ 
;++ 
},, 	
}-- 
}.. ¸	
W/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Models/Dto/ProductDto.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $
Models$ *
;* +
public 
class 

ProductDto 
{ 
public 

int 
	ProductId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

double		 
Price		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
public

 

string

 
Description

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
ImageUrl 
{ 
get  
;  !
set" %
;% &
}' (
} ·
X/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Models/Dto/ResponseDto.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $
Models$ *
;* +
public 
class 
ResponseDto 
{ 
public 

bool 
	IsSuccess 
{ 
get 
;  
set! $
;$ %
}& '
=( )
true* .
;. /
public 

object 
Result 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
DisplayMessages !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 4
;4 5
public 

List 
< 
string 
> 
ErrorMessages %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
}		 ◊
P/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Models/Product.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $
Models$ *
;* +
public 
class 
Product 
{ 
[ 
Key 
] 	
public 

int 
	ProductId 
{ 
get 
; 
set  #
;# $
}% &
[		 
Required		 
]		 
public

 

string

 
Name

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
[ 
Range 

(
 
$num 
, 
$num 
) 
] 
public 

double 
Price 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
CategoryName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
ImageUrl 
{ 
get  
;  !
set" %
;% &
}' (
} ê6
I/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Program.cs
var		 
builder		 
=		 
WebApplication		 
.		 
CreateBuilder		 *
(		* +
args		+ /
)		/ 0
;		0 1
var 
connectionString 
= 
builder 
. 
Configuration ,
., -
GetConnectionString- @
(@ A
$strA T
)T U
;U V
builder 
. 
Services 
. 
AddDbContext 
<  
ApplicationDbContext 2
>2 3
(3 4
options4 ;
=>< >
options 
. 
UseSqlServer 
( 
connectionString )
)) *
)* +
;+ ,
IMapper 
mapper 
= 
MappingConfig 
. 
RegisterMap *
(* +
)+ ,
., -
CreateMapper- 9
(9 :
): ;
;; <
builder 
. 
Services 
. 
AddSingleton 
( 
mapper $
)$ %
;% &
builder 
. 
Services 
. 
AddAutoMapper 
( 
	AppDomain (
.( )
CurrentDomain) 6
.6 7
GetAssemblies7 D
(D E
)E F
)F G
;G H
builder 
. 
Services 
. 
	AddScoped 
< 
IProductRepository -
,- .
ProductRepository/ @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddAuthentication "
(" #
$str# +
)+ ,
. 
AddJwtBearer 
( 
$str 
, 
options #
=>$ &
{ 
if 

( 
builder 
. 
Environment 
.  
IsDevelopment  -
(- .
). /
)/ 0
{ 	
} 	
options   
.   
	Authority   
=   
$str   5
;  5 6
options!! 
.!! %
TokenValidationParameters!! )
=!!* +
new!!, /%
TokenValidationParameters!!0 I
{"" 	
ValidateAudience## 
=## 
false## $
,##$ %
}$$ 	
;$$	 

}%% 
)%% 
;%% 
builder'' 
.'' 
Services'' 
.'' 
AddAuthorization'' !
(''! "
options''" )
=>''* ,
{(( 
options)) 
.)) 
	AddPolicy)) 
()) 
$str))  
,))  !
policy))" (
=>))) +
{** 
policy++ 
.++ $
RequireAuthenticatedUser++ '
(++' (
)++( )
;++) *
policy,, 
.,, 
RequireClaim,, 
(,, 
$str,, #
,,,# $
$str,,% ,
),,, -
;,,- .
}-- 
)-- 
;-- 
}.. 
).. 
;.. 
builder11 
.11 
Services11 
.11 #
AddEndpointsApiExplorer11 (
(11( )
)11) *
;11* +
builder22 
.22 
Services22 
.22 
AddSwaggerGen22 
(22 
c22  
=>22! #
{33 
c44 
.44 

SwaggerDoc44 
(44 
$str44 
,44 
new44 
OpenApiInfo44 &
{44& '
Title44( -
=44. /
$str440 K
}44K L
)44L M
;44M N
c55 
.55 
EnableAnnotations55 
(55 
)55 
;55 
c66 
.66 !
AddSecurityDefinition66 
(66 
$str66 $
,66$ %
new66& )!
OpenApiSecurityScheme66* ?
{77 
Description88 
=88 
$str88 >
,88> ?
Name99 
=99 
$str99 
,99 
In:: 

=::
 
ParameterLocation:: 
.:: 
Header:: $
,::$ %
Type;; 
=;; 
SecuritySchemeType;; !
.;;! "
ApiKey;;" (
,;;( )
Scheme<< 
=<< 
$str<< 
}== 
)== 
;== 
c>> 
.>> "
AddSecurityRequirement>> 
(>> 
new>>  &
OpenApiSecurityRequirement>>! ;
{>>; <
{?? 	
new@@ !
OpenApiSecurityScheme@@ %
{AA 
	ReferenceBB 
=BB 
newBB 
OpenApiReferenceBB  0
{CC 
TypeDD 
=DD 
ReferenceTypeDD (
.DD( )
SecuritySchemeDD) 7
,DD7 8
IdEE 
=EE 
$strEE !
}FF 
,FF 
SchemeGG 
=GG 
$strGG !
,GG! "
NameHH 
=HH 
$strHH 
,HH  
InII 
=II 
ParameterLocationII &
.II& '
HeaderII' -
}JJ 
,JJ 
newKK 
ListKK 
<KK 
stringKK 
>KK 
(KK 
)KK 
}LL 	
}MM 
)MM 
;MM 
}NN 
)NN 
;NN 
varPP 
appPP 
=PP 	
builderPP
 
.PP 
BuildPP 
(PP 
)PP 
;PP 
ifSS 
(SS 
appSS 
.SS 
EnvironmentSS 
.SS 
IsDevelopmentSS !
(SS! "
)SS" #
)SS# $
{TT 
appUU 
.UU 

UseSwaggerUU 
(UU 
)UU 
;UU 
appVV 
.VV 
UseSwaggerUIVV 
(VV 
)VV 
;VV 
}WW 
appYY 
.YY 
UseHttpsRedirectionYY 
(YY 
)YY 
;YY 
appZZ 
.ZZ 
UseAuthenticationZZ 
(ZZ 
)ZZ 
;ZZ 
app[[ 
.[[ 
UseAuthorization[[ 
([[ 
)[[ 
;[[ 
app]] 
.]] 
MapControllers]] 
(]] 
)]] 
;]] 
app__ 
.__ 
Run__ 
(__ 
)__ 	
;__	 
‰
_/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Repository/IProductRepository.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $

Repository$ .
;. /
public 
	interface 
IProductRepository #
{ 
Task 
< 	
IEnumerable	 
< 

ProductDto 
>  
>  !
GetProducts" -
(- .
). /
;/ 0
Task 
< 	

ProductDto	 
> 
GetProductById #
(# $
int$ '
	productId( 1
)1 2
;2 3
Task		 
<		 	

ProductDto			 
>		 
CreateUpdateProduct		 (
(		( )

ProductDto		) 3

productDto		4 >
)		> ?
;		? @
Task

 
<

 	
bool

	 
>

 
DeleteProduct

 
(

 
int

  
	productId

! *
)

* +
;

+ ,
} ‘)
^/home/manuel/sources/MangoRestaurant/Mango.Services.ProductAPI/Repository/ProductRepository.cs
	namespace 	
Mango
 
. 
Services 
. 

ProductAPI #
.# $

Repository$ .
;. /
public 
class 
ProductRepository 
: 
IProductRepository  2
{		 
private

 
readonly

  
ApplicationDbContext

 )
_db

* -
;

- .
private 
IMapper 
_mapper 
; 
public 

ProductRepository 
(  
ApplicationDbContext 1
db2 4
,4 5
IMapper6 =
mapper> D
)D E
{ 
_db 
= 
db 
; 
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
IEnumerable !
<! "

ProductDto" ,
>, -
>- .
GetProducts/ :
(: ;
); <
{ 
IEnumerable 
< 
Product 
> 
productList (
=) *
await+ 0
_db1 4
.4 5
Products5 =
.= >
ToListAsync> I
(I J
)J K
;K L
return 
_mapper 
. 
Map 
< 
List 
<  

ProductDto  *
>* +
>+ ,
(, -
productList- 8
)8 9
;9 :
} 
public 

async 
Task 
< 

ProductDto  
>  !
GetProductById" 0
(0 1
int1 4
	productId5 >
)> ?
{ 
Product 
product 
= 
await 
_db  #
.# $
Products$ ,
., -
Where- 2
(2 3
x3 4
=>4 6
x6 7
.7 8
	ProductId8 A
==A C
	productIdC L
)L M
.M N
FirstOrDefaultAsyncN a
(a b
)b c
;c d
return 
_mapper 
. 
Map 
< 

ProductDto %
>% &
(& '
product' .
). /
;/ 0
} 
public 

async 
Task 
< 

ProductDto  
>  !
CreateUpdateProduct" 5
(5 6

ProductDto6 @

productDtoA K
)K L
{   
var!! 
product!! 
=!! 
_mapper!! 
.!! 
Map!! !
<!!! "

ProductDto!!" ,
,!!, -
Product!!. 5
>!!5 6
(!!6 7

productDto!!7 A
)!!A B
;!!B C
if"" 

("" 
product"" 
."" 
	ProductId"" 
>"" 
$num""  !
)""! "
{## 	
_db$$ 
.$$ 
Products$$ 
.$$ 
Update$$ 
($$  
product$$  '
)$$' (
;$$( )
}%% 	
else&& 
{'' 	
_db(( 
.(( 
Products(( 
.(( 
Add(( 
((( 
product(( $
)(($ %
;((% &
})) 	
await++ 
_db++ 
.++ 
SaveChangesAsync++ "
(++" #
)++# $
;++$ %
return,, 
_mapper,, 
.,, 
Map,, 
<,, 
Product,, "
,,," #

ProductDto,,$ .
>,,. /
(,,/ 0
product,,0 7
),,7 8
;,,8 9
}-- 
public// 

async// 
Task// 
<// 
bool// 
>// 
DeleteProduct// )
(//) *
int//* -
	productId//. 7
)//7 8
{00 
try11 
{22 	
var33 
product33 
=33 
await33 
_db33  #
.33# $
Products33$ ,
.33, -
FirstOrDefaultAsync33- @
(33@ A
u33A B
=>33C E
u33F G
.33G H
	ProductId33H Q
==33R T
	productId33U ^
)33^ _
;33_ `
if44 
(44 
product44 
==44 
null44 
)44  
return44! '
false44( -
;44- .
_db55 
.55 
Products55 
.55 
Remove55 
(55  
product55  '
)55' (
;55( )
await66 
_db66 
.66 
SaveChangesAsync66 &
(66& '
)66' (
;66( )
return77 
true77 
;77 
}88 	
catch99 
(99 
	Exception99 
e99 
)99 
{:: 	
Console;; 
.;; 
	WriteLine;; 
(;; 
e;; 
);;  
;;;  !
throw<< 
;<< 
}== 	
}>> 
}?? 